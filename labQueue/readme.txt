принцип выдачи талона

талоны разбиты на временные интервалы длительностью 15 минут
в каждом интервале по нормативу может быть принять 18 человек.
в каждом интервале имеется 2 резервных талона в конце интервала.
итого в интервале 20 талонов.


варианты выдачи талона:
1. пришел с опазданием - талон выдается из резервных начиная с текущего временного интервала
2. пришел вовремя - талон выдается из основных в текущем временном интервале
3. пришел раньше времени - талон выдается из основных в своем временном интервале

таким образом:
опаздавший имеет возможность попасть в лабораторию в текущем временном интервале если есть резервные талоны иначе - подождет 15 минут. 
зависит от количества резервных талонов и количества опаздывающих

пришедший вовремя - всегда будет обслужен в свое время 
пришедший раньше времени - будет обслужен либо "сейчас" - если если свободное время в лаборатории - либо по любому в свое время




работа регистратора - просто по назначению кликнуть на кнопку в нужном временном диапазоне. ничего анализировать не надо
в идеале - связка в клинсервисами и сканером штрих кода - поднес направление - считался пациент и его время - выдался талон. можно обойтись терминалом без человека


при выдаче талона:
обновляется страница у регистратора
обновляется страница на табло
печатается талон в принтере



работа лаборанта

вызов следующего:
отправляется сигнал на сервер - лаборант №2 вызывает следующего
1. выбирается следующий талон
2. ему меняется статус
3. обновляется страница на табло
4. обновляется страница у регистратора
4. проговаривается приглашение "талон №53 пройдите к окну №2"

базовый набор полей талицы Talon
id - PK, int, autoincrement
number - varchar(50) - но в целом там номер по порядку в течении дня
local_index - int - номер талона в текущем временном отрезке, для сортировки
period - время временного отрезка талона, начало периода, datetime2
status - int (0-1-2-3) 0 -свободен (никому не выдан), 1-ожидает(выдан, ожидает вызова), 2-активен(приглашается к лаборанту или уже у лаборанта), 4-выполнен(уже побывал у лаборанта, проставляетс якогда лаборант вызываетс ледующего)



на талоне печатать:
дату выдачи талона
временной период на который баз записан пациент(и пометка- опаздание, раньше времени)
номер талона


страницы:
LaboratoryQueueRegistrator
LaboratoryQueueInfoPanel
LaboratoryQueueAdminPanel

Контроллер:
LaboratoryQueue:
	Registrator (btn_clicked, btn_id) - выводит страницу регистратора, обрабатывает кнопки выдачи талонов
	InfoPanel - выводит страницу информационного табло, выводит звук с приглашением
	AdminPanel - выводит страницу с настройками очереди (количество лаборантов, количество основных талонов, резервных талонов)
				имеет кнопки "вызов следующего пациента" по количеству лаборантов
				save
	Api (signal_sender, signal_name, signal_param) - обработка сигналов от службы работающей с COM-портом

элементы разработки:
+страница рагистратора - вывод таблицы талонов - сделано
+страница рагистратора - обработка кнопки выдачи следующего талона - сделано
5 4ч   страница регистратора - печать талона на принтере - не сделано
3 0.5ч страница регистратора - обновление по внешнему сигналу - не сделано

2 4ч   страница инфотабло - +1вывод активных талонов, +следующих по очереди, 2вывод звука, 1обновление по внешнему сигналу - частично сделано
4 1ч   страница админки - редактирование параметров очереди - количество лаборантов, количество талонов  в интервале, количество резервных талонов в интервале, начало интервала, длительность интервала, очистка талонов в текущем дне - не сделано
+1 2ч   контроллер Api - +обработка внешних запросов с параметрами signal_sender, signal_name, signal_param - 







